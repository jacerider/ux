"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(u,i){var m="uxMenu";function a(e,t){this.element=e,this._name=m,this._defaults=u.fn.uxMenu.defaults,this.options=u.extend({},this._defaults,t),this.animationEvent=function(){var e,t=i.createElement("fakeelement"),n={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"animationend",WebkitAnimation:"webkitAnimationEnd"};for(e in n)if("undefined"!==t.style[e])return n[e]}(),this.init()}u.extend(a.prototype,{init:function(){this.buildCache(),this.buildElement(),this.bindEvents()},destroy:function(){this.unbindEvents(),this.$element.removeData()},buildCache:function(){this.$element=u(this.element),this.$menu=this.$element.find("."+m+"-menu"),this.$wrap=this.$menu.find("."+m+"-wrap"),this.$menus=this.$menu.find("."+m+"-level"),this.menusArr=[],this.breadCrumbs=!1,(this.options.breadcrumbNav||this.options.backNav)&&(this.$breadcrumbWrapper=this.$element.find("."+m+"-top")),this.options.backNav&&(this.$backWrapper=this.$element.find("."+m+"-top"));var t=0;this.$menus.each(function(e){u(this).find("."+m+"-link.is-active").length&&(t=e)}),this.current_menu=t},buildElement:function(){var e,r=this,s=[],t=null;this.$menus.each(function(t){var e=u(this),n={$menuEl:e,$menuItems:e.find("."+m+"-item")};r.menusArr.push(n),t===r.current_menu&&(e.addClass(m+"-level--current"),r.setWrapHeight(e)),e.find("."+m+"-link[data-submenu]").each(function(){var e=u(this);r.options.itemIcon&&e.append(r.options.itemIcon);e={menu:e.attr("data-submenu"),name:e.html()};s[t]||(s[t]=[]),s[t].push(e)})}),this.$menus.each(function(i){var a=u(this).attr("data-menu");s.forEach(function(e,n){e.forEach(function(e,t){e.menu===a&&(r.menusArr[i].backIdx=n,r.menusArr[i].name=e.name)})})}),r.options.backNav&&(t=r.fetchSelector(r.options.backSelector))&&(t.find("."+m+"-back").remove(),r.$backNav=u('<a class="'+m+'-back" aria-label="'+r.options.backText+'" href="#"></a>').prependTo(t),e=r.options.backText,r.options.backIcon&&(e=r.options.backIcon+" "+e),r.$backNav.html(e),0!==r.current_menu)&&r.$backNav.addClass("animate-fadeIn"),r.options.breadcrumbNav&&(t=r.fetchSelector(r.options.breadcrumbSelector))&&(t.find("."+m+"-breadcrumbs").remove(),r.$breadcrumbNav=u('<nav class="'+m+'-breadcrumbs" aria-label="You are here"></nav>').prependTo(t),r.addBreadcrumb(0),0!==r.menusArr[r.current_menu].backIdx&&0!==r.current_menu&&(r.crawlCrumbs(r.menusArr[r.current_menu].backIdx,r.menusArr),r.breadCrumbs=!0),0!==r.current_menu)&&(r.addBreadcrumb(r.current_menu),r.breadCrumbs=!0)},fetchSelector:function(e){var t=this.$element.find(e);return(t=t.length?t:u(e).first()).length?t:null},bindEvents:function(){for(var r=this,e=0,t=this.menusArr.length;e<t;++e)this.menusArr[e].$menuItems.each(function(a){u(this).find("."+m+"-link[data-submenu]").on("click",function(e){var t=u(this),n=t.html(),i=t.attr("data-submenu"),i=r.$menu.find("."+m+'-level[data-menu="'+i+'"]');i.length?(e.preventDefault(),r.openSubMenu(i,a,n)):(r.$menu.find("."+m+"-link--current").removeClass(m+"-link--current"),t.addClass(m+"-link--current"))})});this.options.backNav&&this.$backNav.on("click",function(e){e.preventDefault(),r.back()})},addBreadcrumb:function(n){if(!this.options.breadcrumbNav)return!1;var i=this,e=n?this.menusArr[n].name.replace(/<([^>]+?)([^>]*?)>(.*?)<\/\1>/gi,""):this.options.breadcrumbText,a=u('<span class="uxMenu-breadcrumb">');!n&&i.options.breadcrumbIcon&&(e=i.options.breadcrumbIcon+e),n&&i.options.breadcrumbSeparatorIcon&&a.html(i.options.breadcrumbSeparatorIcon),u('<a href="#"></a>').html(e).appendTo(a).on("click",function(e){if(e.preventDefault(),!a.next().length||i.isAnimating)return!1;i.isAnimating=!0,i.menuOut();var e=i.menusArr[n].$menuEl,t=(i.menuIn(e),a.nextAll());t.one(i.animationEvent,function(e){t.remove()}).addClass("animate-fadeOut")}),this.$breadcrumbNav.append(a),a.addClass("animate-fadeIn")},crawlCrumbs:function(e,t){this.log("Crawl Crumbs"),0!==t[e].backIdx&&this.crawlCrumbs(t[e].backIdx,t),this.addBreadcrumb(e)},openSubMenu:function(e,t,n){if(this.isAnimating)return!1;var i=this.$menus.index(e);this.isAnimating=!0,this.menusArr[i].backIdx=this.current_menu,this.menusArr[i].name=n,this.menuOut(t),this.menuIn(e,t)},back:function(){if(this.isAnimating)return!1;this.isAnimating=!0,this.menuOut();var e=this.menusArr[this.menusArr[this.current_menu].backIdx].$menuEl;this.menuIn(e),this.options.breadcrumbNav&&this.$breadcrumbNav.children().last().remove()},menuOut:function(t){var n=this,e=this.menusArr[this.current_menu].$menuEl,i=void 0===t;this.menusArr[this.current_menu].$menuItems.each(function(e){this.style.WebkitAnimationDelay=this.style.animationDelay=i?parseInt(e*n.options.itemDelayInterval)+"ms":parseInt(Math.abs(t-e)*n.options.itemDelayInterval)+"ms"}),"r2l"===this.options.direction?e.addClass(i?"animate-outToRight":"animate-outToLeft"):e.addClass(i?"animate-outToLeft":"animate-outToRight")},setWrapHeight:function(e){var t=this,n=(e=e||this.$menus.filter("."+m+"-level--current"),this.$wrap.height()),i=0;e.children().each(function(){i+=u(this).outerHeight()}),t.$element.offsetParent().animate({scrollTop:0},1e3),n<=i?this.$wrap.height(i):e.one(this.animationEvent,function(e){t.$wrap.height(i)})},menuIn:function(t,n){var i=this,a=this.menusArr[this.current_menu].$menuEl,r=void 0===n,s=this.$menus.index(t),e=this.menusArr[s].$menuItems,o=e.length;i.setWrapHeight(t),r?0===s&&i.options.backNav&&i.$backNav.removeClass("animate-fadeIn").addClass("animate-fadeOut"):(i.options.backNav&&i.$backNav.removeClass("animate-fadeOut").addClass("animate-fadeIn"),i.addBreadcrumb(s)),e.each(function(e){this.style.WebkitAnimationDelay=this.style.animationDelay=r?parseInt(e*i.options.itemDelayInterval)+"ms":parseInt(Math.abs(n-e)*i.options.itemDelayInterval)+"ms",e===(n<=o/2||r?o-1:0)&&u(this).one(i.animationEvent,function(e){"r2l"===i.options.direction?(a.removeClass(r?"animate-outToRight":"animate-outToLeft"),t.removeClass(r?"animate-inFromLeft":"animate-inFromRight")):(a.removeClass(r?"animate-outToLeft":"animate-outToRight"),t.removeClass(r?"animate-inFromRight":"animate-inFromLeft")),a.removeClass(m+"-level--current"),t.addClass(m+"-level--current"),i.current_menu=s,i.isAnimating=!1,t.focus()})}),"r2l"===this.options.direction?t.addClass(r?"animate-inFromLeft":"animate-inFromRight"):t.addClass(r?"animate-inFromRight":"animate-inFromLeft")},unbindEvents:function(){this.$element.off("."+this._name)},log:function(e){this.options.debug&&("object"===_typeof(e)?console.log("["+this._name+"]",e):console.log("["+this._name+"] "+e))},error:function(e){"object"===_typeof(e)?console.error("["+this._name+"]",e):console.error("["+this._name+"] "+e)}}),u.fn.uxMenu=function(t){var n,i=arguments;return"undefined"===t||"object"===_typeof(t)?this.each(function(){u.data(this,m)||u.data(this,m,new a(this,t))}):"string"==typeof t&&"_"!==t[0]&&"init"!==t?(this.each(function(){var e=u.data(this,m);e instanceof a&&"function"==typeof e[t]&&(n=e[t].apply(e,Array.prototype.slice.call(i,1))),"destroy"===t&&u.data(this,"plugin_"+m,null)}),"undefined"!==n?n:this):void 0},u.fn.uxMenu.defaults={debug:!1,backNav:!1,backText:"Back",backIcon:"",breadcrumbNav:!0,backSelector:"."+m+"-top",breadcrumbText:"All",breadcrumbIcon:"",breadcrumbSeparatorIcon:"",breadcrumbSelector:"."+m+"-top",itemIcon:"",itemDelayInterval:60,direction:"r2l",theme:"",relocateNav:"",onItemClick:null}}(jQuery,(window,document));