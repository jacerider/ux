"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(x,t){function n(e,t){this.settings=x.extend(!0,{},this._defaults,t),this.element=e,this.layers=x(this.settings.selector.layer,this.element),this.fit=x(this.settings.selector.fit,this.element),this.background=x(this.settings.selector.background,this.element),this.background.length||(this.background=x(this.settings.selector.background_inside,this.element).find("img:first").addClass("ux-parallax-background")),this.source=this.settings.source||this.element,this.parent=this.settings.parent||this.element.parent(),this.window=this.settings.scroller,0<this.background.length&&!this.settings.animateElement?this.settings.animateElement=!1:this.settings.animateElement=!0,this.debug=!1,this.size={window:{},source:{},parent:{},element:{},background:{},layer:[]},this.position={window:{},source:{},element:{},parent:{}},this.loaded=!1,this.initialize()}x.extend(n,{instances:{},initialize:function(){x("body").addClass("has-ux-parallax")}}),x.extend(n.prototype,{_defaults:{animation:"y",animate:"TweenLite",optimize:!0,initialAnimationDuration:1,orientation:"vertical",factor:.5,screen:{sm:0,md:640,lg:1024},perspective:800,perspectiveOrigin:"50% 50%",preload:!0,preloader:'<div class="ux-parallax-loader"><div class="ux-parallax-loader-inner"></div></div>',normalizeTop:!0,overflow:!1,anchor:"center",size:"auto",scroller:x(window),selector:{layer:".ux-parallax-layer",background:".ux-parallax-background",background_inside:".ux-parallax-background-inside",fit:".ux-parallax-fit"}},initialize:function(){var e=this;e.set_element_id(),e.set_animator(),e.set_orientation(e.settings.orientation),e.set_layer_index(),e.init_animus(),e.set_data(),e.set_classes(),e.load(function(){e.set_size(),e.set_position(),e.set_responsive_context(),e.bind_resize(),e.bind_scroll(),e.scroll(),e.loaded=!0,e.element.triggerHandler("ux_parallax.load",[e.element]),e.source.addClass("ux-parallax-built"),e.log("UxParallax has been initialized.")})},parallax:function(){var e,g,t,m,u=this,w=u.position.window[u.param.middle]-u.position.source[u.param.middle],f=(u.position.window[u.param.end]-u.position.source[u.param.start])/u.size.source.spanning,z=w/u.size.source.spanning;u.position.source.beginning&&(t=(e=u.size.window[u.param.half]-u.position.source[u.param.middle])/u.size.source.spanning,w-=e,f-=t,z-=t),m=w<=0,g=0<=w,u.loaded||(g=m=!1,u.in_view)||(z=f=w=0),x.each(u.animation,function(e,t){var h={},i=t[0],c=t[1][u.current_responsive_size];x.each(c.state,function(e,t){var i,a,s,n,o,r,l,d,p;if("*"!==c.state[e][0]){if(r=c.state[e][0],o=c.state[e][1],a=w*r,d=f*r,s=z*r,!("to-middle"===o&&g||"from-middle"===o&&m)||"opacity"===e)switch(e){case"opacity":"from-middle"===o?(h[e]=1-2*s,1<h[e]&&(h[e]=1)):"to-middle"===o?(h[e]=1+2*s,1<h[e]&&(h[e]=1)):h[e]=1-Math.abs(2*s),h[e]=h[e].toFixed(2);break;case"scale":case"scaleX":case"scaleY":case"scaleZ":h[e]="up"===o?1+d:"down"===o?1+.5*r-d:1+s;break;case"rotation":case"rotationX":case"rotationY":case"rotationZ":h[e]=180*(f-.5)*r;break;case"skewX":case"skewY":case"skewZ":h[e]=180*(f-.5)*r;break;case"x":case"y":0<u.background.length?!u.settings.overflow&&u.size.source.same[u.param.size]&&e===u.param.axis?((l={})[u.param.start]=(u.position.window[u.param.start]-u.position.source[u.param.start])/u.size.source[u.param.size],l[u.param.end]=(u.position.window[u.param.end]-u.position.source[u.param.end])/u.size.source[u.param.size],l.value=0,l[u.param.start]<0?l[u.param.start]=0:l.value=l[u.param.start],0<l[u.param.end]?l[u.param.end]=0:l.value=l[u.param.end],h[e]=l.value*u.size.source[u.param.size]*r):(l=u.size.source.difference*(1+r),i=(l=u.position.element[u.param.start]-a-l)+u.size.element[u.param.size],l>u.position.source[u.param.start]&&i<u.position.source[u.param.end]||(h[e]=a)):h[e]=a,h[e]=h[e].toFixed();break;default:h[e]=a}}else n="to-middle"===(o=c.state[e][3])||"from-middle"===o?2:1,p=Math.abs(t[1])+Math.abs(t[2]),"to-middle"===o&&g||("from-middle"===o?h[e]=m?t[1]:t[1]-p*(f-.5)*n:(p=p*f*n,t[1]>t[2]?h[e]=t[1]-p:h[e]=t[1]+p))}),h.onComplete=function(){u.stop_ticking()},u.loaded?u.animate.set(i,h):u.animate.to(i,u.settings.initialAnimationDuration,h)}),u.element.triggerHandler("ux_parallax.parallax",[f,w,z])},bind_resize:function(){var e=this;t.Ux.addResizeCallback(x.proxy(function(){e.set_size(),e.set_position(),e.set_responsive_context(),e.parallax()},e))},bind_scroll:function(){var e=this;t.Ux.addScrollCallback(x.proxy(function(){e.scroll()},e))},load:function(e){var o,t,i,r=this,a=r.background.add(r.layers.filter("img"));0<a.length?(t=0,r.settings.preloader&&(i=x(r.settings.preloader),r.background.before(i)),o=function(){(t+=1)===a.length&&(r.settings.preloader&&r.animate.to(i,1,{scale:2,opacity:0,onComplete:function(){i.remove()}}),e.call())},a.each(function(e,t){var i=x(t),t=i.parent(),a=!1,s=null!=i.attr("data-ux-parallax-src")?i.attr("data-ux-parallax-src"):i.attr("src"),n=x("<img>");t.is("picture")&&((t=t.clone()).find("img").remove().end(),t.append(n),a=!0),a&&!window.HTMLPictureElement?window.respimage?window.respimage({elements:[n[0]]}):window.picturefill?window.picturefill({elements:[n[0]]}):s&&n.attr("src",s):n.attr("src",s),n.on("load",function(){i.attr("src",s),o()}).on("error",function(){r.error('Image with src="" + src + "" failed to load.'),o()})})):e.call()},set_element_id:function(){var e=this;null!=e.element.attr("id")?e.id=e.element.attr("id"):(e.id=e.get_random_id("ux-parallax"),e.element.attr("id",e.id)),e.log("Element id has been set to "+e.id+".")},get_random_id:function(e){return e+"-"+Math.floor(1e5*Math.random()+1)},set_animator:function(){this.animate=window[this.settings.animate],this.log("Animating using the "+this.settings.animate+" platform.")},set_orientation:function(e){var t=this;t.param={},"vertical"===e?(t.param.size="height",t.param.middle="vmiddle",t.param.start="top",t.param.end="bottom",t.param.axis="y",t.param.scroll="scrollTop",t.param.half="halfHeight"):(t.param.size="width",t.param.middle="hmiddle",t.param.start="left",t.param.end="right",t.param.axis="x",t.param.scroll="scrollLeft",t.param.half="halfWidth")},set_layer_index:function(){var i=this;i.layers.each(function(e,t){x(t).css({"z-index":i.layers.length-e})})},init_animus:function(){var e={duration:this.settings.animation.duration,easing:this.settings.animation.easing};this.animus=new x.animus(e),this.log("Initialized animus parser.")},set_data:function(){var i=this;i.animation=[],i.settings.animateElement&&i.animation.push([i.element,i.get_animation_data("element",i.element)]),0<i.background.length&&(i.animation.push([i.background,i.get_animation_data("background",i.background)]),i.size.background=i.get_size_data("background",i.background)),0<i.layers.length&&(i.animation.layer=[],i.layers.each(function(e,t){t=x(t),i.animation.push([t,i.get_animation_data("layer",t,e)]),i.size.layer.push(i.get_size_data("layer",t,e))})),i.log("UxParallax data has been processed."),i.log(i.animation)},set_canvas_position:function(){var a,s,n,o,r=this;switch(r.settings.anchor){case"center":s=-(r.size.element.width-r.size.source.width)/2,n=-(r.size.element.height-r.size.source.height)/2;break;case"top":s=-(r.size.element.width-r.size.source.width)/2,n=0;break;case"bottom":s=-(r.size.element.width-r.size.source.width)/2,n=-(r.size.element.height-r.size.source.height);break;case"left":s=0,n=-(r.size.element.height-r.size.source.height);break;case"right":s=-(r.size.element.width-r.size.source.width),n=-(r.size.element.height-r.size.source.height)/2;break;case"top-left":n=s=0;break;case"bottom-left":s=0,n=-(r.size.element.height-r.size.source.height);break;case"top-right":s=-(r.size.element.width-r.size.source.width),n=0;break;case"bottom-right":s=-(r.size.element.width-r.size.source.width),n=-(r.size.element.height-r.size.source.height)}0<s&&(s=0),0<n&&(n=0),r.loaded?r.animate.set(r.background,{"margin-top":n,"margin-left":s}):r.animate.to(r.background,r.settings.initialAnimationDuration,{"margin-top":n}),o=r.size.element.width/r.size.background.width,a=r.size.element.height/r.size.background.height,r.layers.each(function(e,t){var i;t=x(t),i={},"top"in r.size.layer[e].position?i.top=a*r.size.layer[e].position.top+n:"bottom"in r.size.layer[e].position&&(i.bottom=a*r.size.layer[e].position.bottom+n),"left"in r.size.layer[e].position?i.left=o*r.size.layer[e].position.left+s:"right"in r.size.layer[e].position&&(i.right=o*r.size.layer[e].position.right+s),"width"in r.size.layer[e]&&(i.width=o*r.size.layer[e].width),"height"in r.size.layer[e]&&(i.height=a*r.size.layer[e].height),r.loaded?r.animate.set(t,i):r.animate.to(t,r.settings.initialAnimationDuration,i)})},get_size_data:function(i,e,t){var a=this,s={},n=null!=e.attr("id")?"#"+e.attr("id"):"",o=null!=e.attr("class")?e.attr("class").split(" ").map(function(e){return"."+e}):[],r=!1;return null!=a.settings.canvas&&null!=a.settings.canvas[i]&&(null!=t?null!=a.settings.canvas[i][t]?r=a.settings.canvas[i][t]:null!=a.settings.canvas[i][n]?r=a.settings.canvas[i][n]:x.each(o,function(e,t){null!=a.settings.canvas[i][t]&&(r=a.settings.canvas[i][t])}):r=a.settings.canvas[i]),null!=e.attr("data-imagine-width")?s.width=parseFloat(e.attr("data-imagine-width")):r&&null!=r.width&&(s.width=parseFloat(a.delete_property(r,"width"))),null!=e.attr("data-imagine-height")?s.height=parseFloat(e.attr("data-imagine-height")):r&&null!=r.height&&(s.height=parseFloat(a.delete_property(r,"height"))),"layer"===i&&(s.position={},null!=e.attr("data-imagine-top")?s.position.top=parseFloat(e.attr("data-imagine-top")):r&&null!=r.top?s.position.top=parseFloat(a.delete_property(r,"top")):null!=e.attr("data-imagine-bottom")?s.position.bottom=parseFloat(e.attr("data-imagine-bottom")):r&&null!=r.bottom?s.position.bottom=parseFloat(a.delete_property(r,"bottom")):s.position.top=0,null!=e.attr("data-imagine-left")?s.position.left=parseFloat(e.attr("data-imagine-left")):r&&null!=r.left?s.position.left=parseFloat(a.delete_property(r,"left")):null!=e.attr("data-imagine-right")?s.position.right=parseFloat(e.attr("data-imagine-right")):r&&null!=r.right?s.position.right=parseFloat(a.delete_property(r,"right")):s.position.left=0),s},get_image_size:function(e){var t={width:"auto"};return null!=e[0].naturalWidth?t.width=e[0].naturalWidth:null!=e[0].width?t.width=e[0].width:null!=e.width&&(t.width=e.width()),t.height="auto",null!=e[0].naturalHeight?t.height=e[0].naturalHeight:null!=e[0].height?t.height=e[0].height:null!=e.height&&(t.height=e.height()),t},get_animation_data:function(i,e,t){var r=this,l={},d="",p=null,a=null!=e.attr("id")?"#"+e.attr("id"):"",s=null!=e.attr("class")?e.attr("class").split(" ").map(function(e){return"."+e}):[];return null!=e.attr("data-ux-parallax")?d=e.attr("data-ux-parallax"):"string"==typeof r.settings.animation?d=r.settings.animation:"object"===_typeof(r.settings.animation)&&("string"==typeof r.settings.animation[i]?d=r.settings.animation[i]:x.isArray(r.settings.animation[i])?"string"==typeof r.settings.animation[i][t]?d=r.settings.animation[i][t]:"object"===_typeof(r.settings.animation[i][t])&&(p=r.settings.animation[i][t],"string"==typeof r.settings.animation[i][t]["*"])&&(d=r.settings.animation[i]["*"]):"object"===_typeof(r.settings.animation[i])?(p=r.settings.animation[i],"string"==typeof r.settings.animation[i]["*"]?d=r.settings.animation[i]["*"]:"string"==typeof r.settings.animation[i][a]?d=r.settings.animation[i][a]:"object"===_typeof(r.settings.animation[i][a])?p=r.settings.animation[i][a]:x.each(s,function(e,t){"string"==typeof r.settings.animation[i][t]&&(d=r.settings.animation[i][t]),"object"===_typeof(r.settings.animation[i][t])&&(p=r.settings.animation[i][t])})):d="string"==typeof r.settings.animation["*"]?r.settings.animation["*"]:""),x.each(Object.keys(r.settings.screen),function(e,t){var i,a,s,n,o;for(n in l[t]={},a={},a=p&&"string"==typeof p[t]?p[t]:d,l[t]=r.animus.get(a),i=l[t].state)Object.prototype.hasOwnProperty.call(i,n)&&(-1===(o=""+(o=i[n])).indexOf("..")?0===(s=o.split(/\s+/)).length?s.push(r.settings.factor):1===s.length&&(""===s[0]&&(s[1]="default",s[0]=r.settings.factor),isNaN(s[0])?(s[1]=s[0],s[0]=r.settings.factor):(s[1]="default",s[0]=parseFloat(s[0]))):(s=["*"],o=o.split(/[\. ]+/),s[1]=parseFloat(o[0]),s[2]=parseFloat(o[1]),2===o.length?s[3]="default":s[3]=o[2]),l[t].state[n]=s)}),l},set_classes:function(){var e,t,i=this;0===x("#ux-parallax-style").length&&(e=".ux-parallax-parent, .ux-parallax-background-inside { perspective: "+i.settings.perspective+"px; -moz-perspective: "+i.settings.perspective+"px; -webkit-perspective: "+i.settings.perspective+"px; perspective-origin: "+i.settings.perspectiveOrigin+"; -moz-perspective-origin: "+i.settings.perspectiveOrigin+"; -webkit-perspective-origin: "+i.settings.perspectiveOrigin+"; backface-visibility: hidden; -moz-backface-visibility: hidden; -webkit-backface-visibility: hidden; }",(t=document.createElement("style")).id="ux-parallax-style",t.type="text/css",t.innerHTML=e,x("head")[0].appendChild(t)),(i.settings.animateElement?i.parent:i.element).addClass("ux-parallax-parent"),0<i.background.length&&i.element.addClass("ux-parallax-canvas"),i.element.addClass("ux-parallax-animated"),i.background.addClass("ux-parallax-animated"),i.layers.addClass("ux-parallax-animated")},set_size:function(){var e,i=this;i.size.window.width=i.window.width(),i.size.window.height=i.window.height(),i.size.window.halfWidth=i.size.window.width/2,i.size.window.halfHeight=i.size.window.height/2,i.fit.length?(i.fit.removeClass("ux-parallax-content"),i.source.height(i.fit.outerHeight(!0)),i.fit.addClass("ux-parallax-content")):"fullscreen"===i.settings.size?i.source.css({width:i.size.window.width,height:i.size.window.height,"max-width":i.size.window.width,"max-height":i.size.window.height}):"screenHeight"===i.settings.size?i.source.height(i.size.window.height):"screenWidth"===i.settings.size&&i.source.width(i.size.window.width),i.size.parent.width=i.parent.outerWidth(!0),i.size.parent.height=i.parent.outerHeight(!0),i.size.source.width=i.source.outerWidth(!0),i.size.source.height=i.source.outerHeight(!0),0<i.background.length?(i.size.background=x.extend(i.get_image_size(i.background),i.size.background),i.size.element.width=i.size.source.width,i.size.element.height=i.size.source.width/i.size.background.width*i.size.background.height,i.size.source.height>i.size.element.height&&(i.size.element.width=i.size.source.height/i.size.background.height*i.size.background.width,i.size.element.height=i.size.source.height),0<(e=(i.size.window.height+i.size.source.height)/2-i.size.element.height)&&(i.size.element.width+=e,i.size.element.height+=e),i.loaded?i.animate.set(i.background,{height:i.size.element.height,width:i.size.element.width}):i.animate.to(i.background,i.settings.initialAnimationDuration,{height:i.size.element.height,width:i.size.element.width})):(i.size.element.width=i.element.outerWidth(!0),i.size.element.height=i.element.outerHeight(!0)),0<i.layers.length&&i.layers.each(function(e,t){i.size.layer[e]=x.extend(i.get_image_size(x(t)),i.size.layer[e])}),i.size.source.same={width:i.size.source.width===i.size.element.width,height:i.size.source.height===i.size.element.height},i.size.source.ratio=i.size.window[i.param.size]/i.size.source[i.param.size],i.size.source.difference=i.size.window[i.param.size]-i.size.source[i.param.size],i.size.source.spanning=i.size.window[i.param.size]+i.size.source[i.param.size],i.log("Element sizes have been set.")},set_position:function(){var e=this;e.position.source.top=e.source.offset().top,e.position.source.bottom=e.position.source.top+e.size.source.height,e.position.source.vmiddle=(e.position.source.top+e.position.source.bottom)/2,e.position.source.left=e.source.offset().left,e.position.source.right=e.position.source.left+e.size.source.width,e.position.source.hmiddle=(e.position.source.left+e.position.source.right)/2,e.position.element.top=e.element.offset().top,e.position.element.bottom=e.position.element.top+e.size.element.height,e.position.element.left=e.element.offset().left,e.position.element.right=e.position.element.left+e.size.element.width,0<e.background.length&&(e.position.background=e.position.element),e.position.parent.top=e.parent.offset().top,e.position.parent.bottom=e.position.parent.top+e.size.parent.height,e.position.parent.left=e.parent.offset().left,e.position.parent.right=e.position.parent.left+e.size.parent.width,e.settings.normalizeTop&&e.position.source[e.param.start]<e.size.window[e.param.size]/2&&e.size.source[e.param.size]<e.size.window[e.param.size]?e.position.source.beginning=!0:e.position.source.beginning=!1,(0<e.background.length||0<e.layers.length)&&e.set_canvas_position(),e.log("Element positions have been set.")},set_responsive_context:function(){var e=this;e.size.window.width>=e.settings.screen.xl?e.current_responsive_size="xl":e.size.window.width>=e.settings.screen.lg?e.current_responsive_size="lg":e.size.window.width>=e.settings.screen.md?e.current_responsive_size="md":e.size.window.width>=e.settings.screen.sm?e.current_responsive_size="sm":e.current_responsive_size="xs",e.log("Responsive context is "+e.current_responsive_size+".")},ticking:!1,stop_ticking:function(){this.ticking=!1},start_ticking:function(){this.ticking=!0},in_view_eariler:!1,scroll:function(){var e,t=this;if(t.position.window[t.param.start]=t.window[t.param.scroll](),t.position.window[t.param.end]=t.position.window[t.param.start]+t.size.window[t.param.size],t.position.window[t.param.middle]=t.position.window[t.param.start]+t.size.window[t.param.half],e=t.element[0]._gsTransform&&t.element[0]._gsTransform[t.param.axis]?t.element[0]._gsTransform[t.param.axis]:0,e=t.size.window[t.param.half]-e,t.in_view=!(t.position.window[t.param.end]-t.position.source[t.param.start]+e<0||0<t.position.window[t.param.start]-t.position.source[t.param.end]-e),t.in_view)t.in_view_eariler||(t.in_view_eariler=!0,t.element.addClass("ux-parallax-visible"),t.element.removeClass("ux-parallax-hidden"),t.element.triggerHandler("ux_parallax.visible",[t.in_view]));else if(t.in_view_eariler&&(t.in_view_eariler=!1,t.element.removeClass("ux-parallax-visible"),t.element.addClass("ux-parallax-hidden"),t.element.triggerHandler("ux_parallax.visible",[t.in_view])),t.loaded)return;t.ticking||(t.start_ticking(),t.parallax())},log:function(e){this.debug&&("object"===_typeof(e)?console.log("[UxParallax "+this.id+"]",e):console.log("[UxParallax "+this.id+"] "+e))},error:function(e){"object"===_typeof(e)?console.error("[UxParallax "+this.id+"]",e):console.error("[UxParallax "+this.id+"] "+e)}}),t.behaviors.uxParallax={attachCount:0,attach:function(e,t){var i,a=x(".ux-parallax",e);if(t.ux&&t.ux.parallax&&t.ux.parallax.items)for(var s in t.ux.parallax.items)t.ux.parallax.items[s]&&(i=x(".ux-parallax-"+s,e).once("ux-parallax")).length&&(n.instances[s]=new n(i,t.ux.parallax.items[s]));this.parallaxAttach(a),n.initialize()},parallaxAttach:function(e){var t,i=this,a=e.first().data("ux-parallax",!0);a.length&&(a.on("ux_parallax.load",function(){e=e.filter(function(){return!0!==x(this).data("ux-parallax")}),i.parallaxAttach(e)}),t="attach-"+i.attachCount,i.attachCount++,n.instances[t]=new n(a))}},t.UxParallax=n}(jQuery,Drupal,(drupalSettings,Drupal.displace));