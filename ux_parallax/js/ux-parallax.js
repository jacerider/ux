!function(e,t,i,a){"use strict";function s(t,i){this.settings=e.extend(!0,{},this._defaults,i),this.element=t,this.layers=e(this.settings.selector.layer,this.element),this.fit=e(this.settings.selector.fit,this.element),this.background=e(this.settings.selector.background,this.element),this.background.length||(this.background=e(this.settings.selector.background_inside,this.element).find("img:first").addClass("ux-parallax-background")),this.source=this.settings.source?this.settings.source:this.element,this.parent=this.settings.parent?this.settings.parent:this.element.parent(),this.window=this.settings.scroller,this.background.length>0&&!this.settings.animateElement?this.settings.animateElement=!1:this.settings.animateElement=!0,this.debug=!1,this.size={window:{},source:{},parent:{},element:{},background:{},layer:[]},this.position={window:{},source:{},element:{},parent:{}},this.loaded=!1,this.initialize()}e.extend(s,{instances:{},initialize:function(){e("body").addClass("has-ux-parallax")}}),e.extend(s.prototype,{_defaults:{animation:"y",animate:"TweenLite",optimize:!0,initialAnimationDuration:1,orientation:"vertical",factor:.5,screen:{sm:0,md:640,lg:1024},perspective:800,perspectiveOrigin:"50% 50%",preload:!0,preloader:'<div class="ux-parallax-loader"><div class="ux-parallax-loader-inner"></div></div>',normalizeTop:!0,overflow:!1,anchor:"center",size:"auto",scroller:e(window),selector:{layer:".ux-parallax-layer",background:".ux-parallax-background",background_inside:".ux-parallax-background-inside",fit:".ux-parallax-fit"}},initialize:function(){var e=this;e.set_element_id(),e.set_animator(),e.set_orientation(e.settings.orientation),e.set_layer_index(),e.init_animus(),e.set_data(),e.set_classes(),e.load(function(){e.set_size(),e.set_position(),e.set_responsive_context(),e.bind_resize(),e.bind_scroll(),e.scroll(),e.loaded=!0,e.element.triggerHandler("ux_parallax.load",[e.element]),e.source.addClass("ux-parallax-built"),e.log("UxParallax has been initialized.")})},parallax:function(){var t,i,a,s,n,o,r,l=this;t=l.position.window[l.param.middle]-l.position.source[l.param.middle],n=(l.position.window[l.param.end]-l.position.source[l.param.start])/l.size.source.spanning,a=t/l.size.source.spanning,l.position.source.beginning&&(i=l.size.window[l.param.half]-l.position.source[l.param.middle],o=i/l.size.source.spanning,t-=i,n-=o,a-=o),r=t<=0,s=t>=0,l.loaded||(r=!1,s=!1,l.in_view||(t=0,n=0,a=0)),e.each(l.animation,function(i,o){var d,p,h;d={},h=o[0],p=o[1][l.current_responsive_size],e.each(p.state,function(e,i){var o,h,c,g,m,u,w,z,f,x,b,_;if("*"===p.state[e][0]){if(w=p.state[e][3],u="to-middle"===w||"from-middle"===w?2:1,_=Math.abs(i[1])+Math.abs(i[2]),"to-middle"===w&&s)return;return void("from-middle"===w?r?d[e]=i[1]:d[e]=i[1]-_*(n-.5)*u:(b=_*n*u,i[1]>i[2]?d[e]=i[1]-b:d[e]=i[1]+b))}if(z=p.state[e][0],w=p.state[e][1],c=t*z,x=n*z,g=a*z,!("to-middle"===w&&s||"from-middle"===w&&r)||"opacity"===e)switch(e){case"opacity":"from-middle"===w?(d[e]=1-2*g,d[e]>1&&(d[e]=1)):"to-middle"===w?(d[e]=1+2*g,d[e]>1&&(d[e]=1)):d[e]=1-Math.abs(2*g),d[e]=d[e].toFixed(2);break;case"scale":case"scaleX":case"scaleY":case"scaleZ":"up"===w?d[e]=1+x:"down"===w?d[e]=1+.5*z-x:d[e]=1+g;break;case"rotation":case"rotationX":case"rotationY":case"rotationZ":d[e]=180*(n-.5)*z;break;case"skewX":case"skewY":case"skewZ":d[e]=180*(n-.5)*z;break;case"x":case"y":l.background.length>0?!l.settings.overflow&&l.size.source.same[l.param.size]&&e===l.param.axis?(f={},f[l.param.start]=(l.position.window[l.param.start]-l.position.source[l.param.start])/l.size.source[l.param.size],f[l.param.end]=(l.position.window[l.param.end]-l.position.source[l.param.end])/l.size.source[l.param.size],f.value=0,f[l.param.start]<0?f[l.param.start]=0:f.value=f[l.param.start],f[l.param.end]>0?f[l.param.end]=0:f.value=f[l.param.end],d[e]=f.value*l.size.source[l.param.size]*z):(m=l.size.source.difference*(1+z),o=l.position.element[l.param.start]-c-m,h=o+l.size.element[l.param.size],o>l.position.source[l.param.start]&&h<l.position.source[l.param.end]||(d[e]=c)):d[e]=c,d[e]=d[e].toFixed();break;default:d[e]=c}}),d.onComplete=function(){l.stop_ticking()},l.loaded?l.animate.set(h,d):l.animate.to(h,l.settings.initialAnimationDuration,d)}),l.element.triggerHandler("ux_parallax.parallax",[n,t,a])},bind_resize:function(){var i=this;t.Ux.addResizeCallback(e.proxy(function(){i.set_size(),i.set_position(),i.set_responsive_context(),i.parallax()},i))},bind_scroll:function(){var i=this;t.Ux.addScrollCallback(e.proxy(function(){i.scroll()},i))},load:function(t){var i,a,s,n,o=this;a=o.background.add(o.layers.filter("img")),a.length>0?(s=0,o.settings.preloader&&(n=e(o.settings.preloader),o.background.before(n)),i=function(){s+=1,s===a.length&&(o.settings.preloader&&o.animate.to(n,1,{scale:2,opacity:0,onComplete:function(){n.remove()}}),t.call())},a.each(function(t,a){var s,n,r,l,d;s=e(a),n=s.parent(),r=!1,d=null!=s.attr("data-ux-parallax-src")?s.attr("data-ux-parallax-src"):s.attr("src"),l=e("<img>"),n.is("picture")&&(n=n.clone(),n.find("img").remove().end(),n.append(l),r=!0),r&&!window.HTMLPictureElement?window.respimage?window.respimage({elements:[l[0]]}):window.picturefill?window.picturefill({elements:[l[0]]}):d&&l.attr("src",d):l.attr("src",d),l.on("load",function(){s.attr("src",d),i()}).on("error",function(){o.error('Image with src="" + src + "" failed to load.'),i()})})):t.call()},set_element_id:function(){var e=this;null!=e.element.attr("id")?e.id=e.element.attr("id"):(e.id=e.get_random_id("ux-parallax"),e.element.attr("id",e.id)),e.log("Element id has been set to "+e.id+".")},get_random_id:function(e){return e+"-"+Math.floor(1e5*Math.random()+1)},set_animator:function(){var e=this;e.animate=window[e.settings.animate],e.log("Animating using the "+e.settings.animate+" platform.")},set_orientation:function(e){var t=this;t.param={},"vertical"===e?(t.param.size="height",t.param.middle="vmiddle",t.param.start="top",t.param.end="bottom",t.param.axis="y",t.param.scroll="scrollTop",t.param.half="halfHeight"):(t.param.size="width",t.param.middle="hmiddle",t.param.start="left",t.param.end="right",t.param.axis="x",t.param.scroll="scrollLeft",t.param.half="halfWidth")},set_layer_index:function(){var t=this;t.layers.each(function(i,a){e(a).css({"z-index":t.layers.length-i})})},init_animus:function(){var t,i=this;t={duration:i.settings.animation.duration,easing:i.settings.animation.easing},i.animus=new e.animus(t),i.log("Initialized animus parser.")},set_data:function(){var t=this;t.animation=[],t.settings.animateElement&&t.animation.push([t.element,t.get_animation_data("element",t.element)]),t.background.length>0&&(t.animation.push([t.background,t.get_animation_data("background",t.background)]),t.size.background=t.get_size_data("background",t.background)),t.layers.length>0&&(t.animation.layer=[],t.layers.each(function(i,a){a=e(a),t.animation.push([a,t.get_animation_data("layer",a,i)]),t.size.layer.push(t.get_size_data("layer",a,i))})),t.log("UxParallax data has been processed."),t.log(t.animation)},set_canvas_position:function(){var t,i,a,s,n=this;switch(n.settings.anchor){case"center":i=-(n.size.element.width-n.size.source.width)/2,a=-(n.size.element.height-n.size.source.height)/2;break;case"top":i=-(n.size.element.width-n.size.source.width)/2,a=0;break;case"bottom":i=-(n.size.element.width-n.size.source.width)/2,a=-(n.size.element.height-n.size.source.height);break;case"left":i=0,a=-(n.size.element.height-n.size.source.height);break;case"right":i=-(n.size.element.width-n.size.source.width),a=-(n.size.element.height-n.size.source.height)/2;break;case"top-left":i=0,a=0;break;case"bottom-left":i=0,a=-(n.size.element.height-n.size.source.height);break;case"top-right":i=-(n.size.element.width-n.size.source.width),a=0;break;case"bottom-right":i=-(n.size.element.width-n.size.source.width),a=-(n.size.element.height-n.size.source.height)}i>0&&(i=0),a>0&&(a=0),n.loaded?n.animate.set(n.background,{"margin-top":a,"margin-left":i}):n.animate.to(n.background,n.settings.initialAnimationDuration,{"margin-top":a}),s=n.size.element.width/n.size.background.width,t=n.size.element.height/n.size.background.height,n.layers.each(function(o,r){var l;r=e(r),l={},"top"in n.size.layer[o].position?l.top=t*n.size.layer[o].position.top+a:"bottom"in n.size.layer[o].position&&(l.bottom=t*n.size.layer[o].position.bottom+a),"left"in n.size.layer[o].position?l.left=s*n.size.layer[o].position.left+i:"right"in n.size.layer[o].position&&(l.right=s*n.size.layer[o].position.right+i),"width"in n.size.layer[o]&&(l.width=s*n.size.layer[o].width),"height"in n.size.layer[o]&&(l.height=t*n.size.layer[o].height),n.loaded?n.animate.set(r,l):n.animate.to(r,n.settings.initialAnimationDuration,l)})},get_size_data:function(t,i,a){var s,n,o,r,l=this;return s={},o=null!=i.attr("id")?"#"+i.attr("id"):"",n=null!=i.attr("class")?i.attr("class").split(" ").map(function(e){return"."+e}):[],r=!1,null!=l.settings.canvas&&null!=l.settings.canvas[t]&&(null!=a?null!=l.settings.canvas[t][a]?r=l.settings.canvas[t][a]:null!=l.settings.canvas[t][o]?r=l.settings.canvas[t][o]:e.each(n,function(e,i){null!=l.settings.canvas[t][i]&&(r=l.settings.canvas[t][i])}):r=l.settings.canvas[t]),null!=i.attr("data-imagine-width")?s.width=parseFloat(i.attr("data-imagine-width")):r&&null!=r.width&&(s.width=parseFloat(l.delete_property(r,"width"))),null!=i.attr("data-imagine-height")?s.height=parseFloat(i.attr("data-imagine-height")):r&&null!=r.height&&(s.height=parseFloat(l.delete_property(r,"height"))),"layer"===t&&(s.position={},null!=i.attr("data-imagine-top")?s.position.top=parseFloat(i.attr("data-imagine-top")):r&&null!=r.top?s.position.top=parseFloat(l.delete_property(r,"top")):null!=i.attr("data-imagine-bottom")?s.position.bottom=parseFloat(i.attr("data-imagine-bottom")):r&&null!=r.bottom?s.position.bottom=parseFloat(l.delete_property(r,"bottom")):s.position.top=0,null!=i.attr("data-imagine-left")?s.position.left=parseFloat(i.attr("data-imagine-left")):r&&null!=r.left?s.position.left=parseFloat(l.delete_property(r,"left")):null!=i.attr("data-imagine-right")?s.position.right=parseFloat(i.attr("data-imagine-right")):r&&null!=r.right?s.position.right=parseFloat(l.delete_property(r,"right")):s.position.left=0),s},get_image_size:function(e){var t;return t={},t.width="auto",null!=e[0].naturalWidth?t.width=e[0].naturalWidth:null!=e[0].width?t.width=e[0].width:null!=e.width&&(t.width=e.width()),t.height="auto",null!=e[0].naturalHeight?t.height=e[0].naturalHeight:null!=e[0].height?t.height=e[0].height:null!=e.height&&(t.height=e.height()),t},get_animation_data:function(t,i,a){var s,n,o,r,l,d=this;return s={},n="",o=null,l=null!=i.attr("id")?"#"+i.attr("id"):"",r=null!=i.attr("class")?i.attr("class").split(" ").map(function(e){return"."+e}):[],null!=i.attr("data-ux-parallax")?n=i.attr("data-ux-parallax"):"string"==typeof d.settings.animation?n=d.settings.animation:"object"==typeof d.settings.animation&&("string"==typeof d.settings.animation[t]?n=d.settings.animation[t]:e.isArray(d.settings.animation[t])?"string"==typeof d.settings.animation[t][a]?n=d.settings.animation[t][a]:"object"==typeof d.settings.animation[t][a]&&(o=d.settings.animation[t][a],"string"==typeof d.settings.animation[t][a]["*"]&&(n=d.settings.animation[t]["*"])):"object"==typeof d.settings.animation[t]?(o=d.settings.animation[t],"string"==typeof d.settings.animation[t]["*"]?n=d.settings.animation[t]["*"]:"string"==typeof d.settings.animation[t][l]?n=d.settings.animation[t][l]:"object"==typeof d.settings.animation[t][l]?o=d.settings.animation[t][l]:e.each(r,function(e,i){"string"==typeof d.settings.animation[t][i]&&(n=d.settings.animation[t][i]),"object"==typeof d.settings.animation[t][i]&&(o=d.settings.animation[t][i])})):n="string"==typeof d.settings.animation["*"]?d.settings.animation["*"]:""),e.each(Object.keys(d.settings.screen),function(e,t){var i,a,r,l,p;s[t]={},a={},a=o&&"string"==typeof o[t]?o[t]:n,s[t]=d.animus.get(a),i=s[t].state;for(l in i)Object.prototype.hasOwnProperty.call(i,l)&&(p=i[l],p=""+p,p.indexOf("..")===-1?(r=p.split(/\s+/),0===r.length?r.push(d.settings.factor):1===r.length&&(""===r[0]&&(r[1]="default",r[0]=d.settings.factor),isNaN(r[0])?(r[1]=r[0],r[0]=d.settings.factor):(r[1]="default",r[0]=parseFloat(r[0]))),s[t].state[l]=r):(r=["*"],p=p.split(/[\. ]+/),r[1]=parseFloat(p[0]),r[2]=parseFloat(p[1]),2===p.length?r[3]="default":r[3]=p[2],s[t].state[l]=r))}),s},set_classes:function(){var t,i,a=this;0===e("#ux-parallax-style").length&&(t=".ux-parallax-parent, .ux-parallax-background-inside { perspective: "+a.settings.perspective+"px; -moz-perspective: "+a.settings.perspective+"px; -webkit-perspective: "+a.settings.perspective+"px; perspective-origin: "+a.settings.perspectiveOrigin+"; -moz-perspective-origin: "+a.settings.perspectiveOrigin+"; -webkit-perspective-origin: "+a.settings.perspectiveOrigin+"; backface-visibility: hidden; -moz-backface-visibility: hidden; -webkit-backface-visibility: hidden; }",i=document.createElement("style"),i.id="ux-parallax-style",i.type="text/css",i.innerHTML=t,e("head")[0].appendChild(i)),a.settings.animateElement?a.parent.addClass("ux-parallax-parent"):a.element.addClass("ux-parallax-parent"),a.background.length>0&&a.element.addClass("ux-parallax-canvas"),a.element.addClass("ux-parallax-animated"),a.background.addClass("ux-parallax-animated"),a.layers.addClass("ux-parallax-animated")},set_size:function(){var t=this;if(t.size.window.width=t.window.width(),t.size.window.height=t.window.height(),t.size.window.halfWidth=t.size.window.width/2,t.size.window.halfHeight=t.size.window.height/2,t.fit.length?(t.fit.removeClass("ux-parallax-content"),t.source.height(t.fit.outerHeight(!0)),t.fit.addClass("ux-parallax-content")):"fullscreen"===t.settings.size?t.source.css({width:t.size.window.width,height:t.size.window.height,"max-width":t.size.window.width,"max-height":t.size.window.height}):"screenHeight"===t.settings.size?t.source.height(t.size.window.height):"screenWidth"===t.settings.size&&t.source.width(t.size.window.width),t.size.parent.width=t.parent.outerWidth(!0),t.size.parent.height=t.parent.outerHeight(!0),t.size.source.width=t.source.outerWidth(!0),t.size.source.height=t.source.outerHeight(!0),t.background.length>0){t.size.background=e.extend(t.get_image_size(t.background),t.size.background),t.size.element.width=t.size.source.width,t.size.element.height=t.size.source.width/t.size.background.width*t.size.background.height,t.size.source.height>t.size.element.height&&(t.size.element.width=t.size.source.height/t.size.background.height*t.size.background.width,t.size.element.height=t.size.source.height);var i=(t.size.window.height+t.size.source.height)/2-t.size.element.height;i>0&&(t.size.element.width+=i,t.size.element.height+=i),t.loaded?t.animate.set(t.background,{height:t.size.element.height,width:t.size.element.width}):t.animate.to(t.background,t.settings.initialAnimationDuration,{height:t.size.element.height,width:t.size.element.width})}else t.size.element.width=t.element.outerWidth(!0),t.size.element.height=t.element.outerHeight(!0);t.layers.length>0&&t.layers.each(function(i,a){t.size.layer[i]=e.extend(t.get_image_size(e(a)),t.size.layer[i])}),t.size.source.same={width:t.size.source.width===t.size.element.width,height:t.size.source.height===t.size.element.height},t.size.source.ratio=t.size.window[t.param.size]/t.size.source[t.param.size],t.size.source.difference=t.size.window[t.param.size]-t.size.source[t.param.size],t.size.source.spanning=t.size.window[t.param.size]+t.size.source[t.param.size],t.log("Element sizes have been set.")},set_position:function(){var e=this;e.position.source.top=e.source.offset().top,e.position.source.bottom=e.position.source.top+e.size.source.height,e.position.source.vmiddle=(e.position.source.top+e.position.source.bottom)/2,e.position.source.left=e.source.offset().left,e.position.source.right=e.position.source.left+e.size.source.width,e.position.source.hmiddle=(e.position.source.left+e.position.source.right)/2,e.position.element.top=e.element.offset().top,e.position.element.bottom=e.position.element.top+e.size.element.height,e.position.element.left=e.element.offset().left,e.position.element.right=e.position.element.left+e.size.element.width,e.background.length>0&&(e.position.background=e.position.element),e.position.parent.top=e.parent.offset().top,e.position.parent.bottom=e.position.parent.top+e.size.parent.height,e.position.parent.left=e.parent.offset().left,e.position.parent.right=e.position.parent.left+e.size.parent.width,e.settings.normalizeTop&&e.position.source[e.param.start]<e.size.window[e.param.size]/2&&e.size.source[e.param.size]<e.size.window[e.param.size]?e.position.source.beginning=!0:e.position.source.beginning=!1,(e.background.length>0||e.layers.length>0)&&e.set_canvas_position(),e.log("Element positions have been set.")},set_responsive_context:function(){var e=this;e.size.window.width>=e.settings.screen.xl?e.current_responsive_size="xl":e.size.window.width>=e.settings.screen.lg?e.current_responsive_size="lg":e.size.window.width>=e.settings.screen.md?e.current_responsive_size="md":e.size.window.width>=e.settings.screen.sm?e.current_responsive_size="sm":e.current_responsive_size="xs",e.log("Responsive context is "+e.current_responsive_size+".")},ticking:!1,stop_ticking:function(){var e=this;e.ticking=!1},start_ticking:function(){var e=this;e.ticking=!0},in_view_eariler:!1,scroll:function(){var e,t,i=this;if(i.position.window[i.param.start]=i.window[i.param.scroll](),i.position.window[i.param.end]=i.position.window[i.param.start]+i.size.window[i.param.size],i.position.window[i.param.middle]=i.position.window[i.param.start]+i.size.window[i.param.half],t=i.element[0]._gsTransform&&i.element[0]._gsTransform[i.param.axis]?i.element[0]._gsTransform[i.param.axis]:0,e=i.size.window[i.param.half]-t,i.in_view=!(i.position.window[i.param.end]-i.position.source[i.param.start]+e<0||i.position.window[i.param.start]-i.position.source[i.param.end]-e>0),i.in_view)i.in_view_eariler||(i.in_view_eariler=!0,i.element.addClass("ux-parallax-visible"),i.element.removeClass("ux-parallax-hidden"),i.element.triggerHandler("ux_parallax.visible",[i.in_view]));else if(i.in_view_eariler&&(i.in_view_eariler=!1,i.element.removeClass("ux-parallax-visible"),i.element.addClass("ux-parallax-hidden"),i.element.triggerHandler("ux_parallax.visible",[i.in_view])),i.loaded)return;i.ticking||(i.start_ticking(),i.parallax())},log:function(e){var t=this;t.debug&&("object"==typeof e?console.log("[UxParallax "+t.id+"]",e):console.log("[UxParallax "+t.id+"] "+e))},error:function(e){var t=this;"object"==typeof e?console.error("[UxParallax "+t.id+"]",e):console.error("[UxParallax "+t.id+"] "+e)}}),t.behaviors.uxParallax={attachCount:0,attach:function(t,i){var a=e(".ux-parallax",t);if(i.ux&&i.ux.parallax&&i.ux.parallax.items)for(var n in i.ux.parallax.items)if(i.ux.parallax.items[n]){var o=e(".ux-parallax-"+n,t).once("ux-parallax");o.length&&(s.instances[n]=new s(o,i.ux.parallax.items[n]))}this.parallaxAttach(a),s.initialize()},parallaxAttach:function(t){var i=this,a=t.first().data("ux-parallax",!0);if(a.length){a.on("ux_parallax.load",function(){t=t.filter(function(){return e(this).data("ux-parallax")!==!0}),i.parallaxAttach(t)});var n="attach-"+i.attachCount;i.attachCount++,s.instances[n]=new s(a)}}},t.UxParallax=s}(jQuery,Drupal,drupalSettings,Drupal.displace);